import{q as N,c as m,o as n,a as e,F as S,h as j,s as T,r as b,w as H,f as x,v as w,g as O,e as y,n as M,p as P,l as B,d as L,m as $,t as h,j as R,b as E,i as V,x as q,y as k,T as A,u as G}from"./index-C5NBT51_.js";import{u as J,P as K}from"./PropertyCard-CrY9A0rD.js";import{P as Q}from"./PropertyCardSkeleton-gUzMxgIh.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"flex flex-wrap gap-4"},Y=["src"],Z=["onClick"],ee={class:"flex items-center justify-center w-32 h-32 border-2 border-dashed rounded-lg cursor-pointer hover:bg-gray-50"},te=N({__name:"ImageUploader",props:{modelValue:{}},emits:["update:modelValue"],setup(a,{emit:f}){const p=a,c=f,d=i=>typeof i=="string"?i:URL.createObjectURL(i),o=i=>{const t=i.target,r=t.files?Array.from(t.files):[];c("update:modelValue",[...p.modelValue,...r])},u=i=>{const t=p.modelValue.filter((r,v)=>v!==i);c("update:modelValue",t)};return(i,t)=>(n(),m("div",X,[(n(!0),m(S,null,j(i.modelValue,(r,v)=>(n(),m("div",{key:v,class:"relative w-32 h-32"},[e("img",{src:d(r),alt:"Preview",class:"w-full h-full object-cover rounded-lg"},null,8,Y),e("button",{onClick:C=>u(v),class:"absolute top-1 right-1 bg-white rounded-full w-6 h-6 flex items-center justify-center shadow-sm hover:bg-gray-100"}," × ",8,Z)]))),128)),e("label",ee,[e("input",{type:"file",accept:"image/*",multiple:"",onChange:o,class:"hidden"},null,32),t[0]||(t[0]=e("span",null,"+ Загрузить изображения",-1))])]))}}),se={class:"bg-white shadow rounded-lg p-6"},oe={class:"space-y-4"},le={class:"bg-white shadow rounded-lg p-6"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ie={class:"bg-white shadow rounded-lg p-6"},ne={class:"flex justify-end gap-4 pt-4"},ae=["disabled"],de=["disabled"],ue={key:0},me={key:1,class:"flex items-center justify-center"},ce={__name:"PropertyForm",props:{modelValue:{type:Object,required:!0,default:()=>({title:"",type:"apartment",description:"",price:"",location:"",images:[]})},isSubmitting:{type:Boolean,default:!1}},emits:["update:modelValue","submit","cancel"],setup(a,{emit:f}){const p=a,c=f,d=T(p.modelValue),o=b({id:d.id||null,title:d.title||"",description:d.description||"",price:d.price||"",location:d.location||"",type:d.type||"apartment",images:Array.isArray(d.images)?[...d.images]:[]});H(()=>p.modelValue,i=>{const t=T(i);o.value={id:t.id||null,title:t.title||"",description:t.description||"",price:t.price||"",location:t.location||"",type:t.type||"apartment",images:Array.isArray(t.images)?[...t.images]:[]}},{deep:!0,immediate:!0});const u=()=>{const i={id:o.value.id,title:o.value.title.trim(),description:o.value.description.trim(),price:Number(o.value.price)||0,location:o.value.location.trim(),type:o.value.type||"apartment",images:Array.isArray(o.value.images)?[...o.value.images]:[]};c("submit",i)};return(i,t)=>(n(),m("form",{onSubmit:B(u,["prevent"]),class:"space-y-6"},[e("div",se,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-100"}," Основная информация ",-1)),e("div",oe,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Название объекта *",-1)),x(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>o.value.title=r),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,o.value.title]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Тип объекта *",-1)),x(e("select",{"onUpdate:modelValue":t[1]||(t[1]=r=>o.value.type=r),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},t[8]||(t[8]=[e("option",{value:"apartment"},"Квартира",-1),e("option",{value:"house"},"Дом",-1),e("option",{value:"commercial"},"Коммерческая",-1)]),512),[[O,o.value.type]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Описание *",-1)),x(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=r=>o.value.description=r),rows:"4",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,o.value.description]])])])]),e("div",le,[t[14]||(t[14]=e("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-100"}," Характеристики ",-1)),e("div",re,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Цена (₽) *",-1)),x(e("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>o.value.price=r),type:"number",min:"0",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,o.value.price,void 0,{number:!0}]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Местоположение *",-1)),x(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>o.value.location=r),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,o.value.location]])])])]),e("div",ie,[t[15]||(t[15]=e("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-100"}," Изображения ",-1)),y(te,{modelValue:o.value.images,"onUpdate:modelValue":t[5]||(t[5]=r=>o.value.images=r)},null,8,["modelValue"])]),e("div",ne,[e("button",{type:"button",onClick:t[6]||(t[6]=r=>i.$emit("cancel")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:a.isSubmitting}," Отмена ",8,ae),e("button",{type:"submit",class:M(["px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",{"opacity-50 cursor-not-allowed":a.isSubmitting}]),disabled:a.isSubmitting},[a.isSubmitting?(n(),m("span",me,t[16]||(t[16]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),P(" Сохранение... ")]))):(n(),m("span",ue,"Сохранить"))],10,de)])],32))}},pe={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},ge={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},be={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},fe={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ve={class:"sm:flex sm:items-start"},he={class:"h-6 w-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xe={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},ye={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},we={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},ke={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},$e={class:"mt-2"},Ce={class:"text-sm text-gray-500"},_e={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Ve={__name:"ConfirmModal",props:{isOpen:Boolean,title:{type:String,default:"Подтверждение"},message:{type:String,required:!0},confirmText:{type:String,default:"Подтвердить"},cancelText:{type:String,default:"Отмена"},variant:{type:String,default:"default",validator:a=>["default","danger","success"].includes(a)}},emits:["confirm","cancel"],setup(a,{emit:f}){const p=a,c=L(()=>({default:"bg-blue-100",danger:"bg-red-100",success:"bg-green-100"})[p.variant]),d=L(()=>({default:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500",danger:"bg-red-600 hover:bg-red-700 focus:ring-red-500",success:"bg-green-600 hover:bg-green-700 focus:ring-green-500"})[p.variant]);return(o,u)=>a.isOpen?(n(),m("div",pe,[e("div",ge,[u[2]||(u[2]=e("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),u[3]||(u[3]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",be,[e("div",fe,[e("div",ve,[e("div",{class:M(["mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full sm:mx-0 sm:h-10 sm:w-10",c.value])},[(n(),m("svg",he,[a.variant==="danger"?(n(),m("path",xe)):(n(),m("path",ye))]))],2),e("div",we,[e("h3",ke,h(a.title),1),e("div",$e,[e("p",Ce,h(a.message),1)])])])]),e("div",_e,[e("button",{type:"button",onClick:u[0]||(u[0]=i=>o.$emit("confirm")),class:M(["w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white sm:ml-3 sm:w-auto sm:text-sm",d.value])},h(a.confirmText),3),e("button",{type:"button",onClick:u[1]||(u[1]=i=>o.$emit("cancel")),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"},h(a.cancelText),1)])])])])):$("",!0)}},Ae={class:"admin-page min-h-screen pb-12 bg-gradient-to-br from-blue-50 to-indigo-50"},Se={class:"container mx-auto px-4 py-8 relative z-10"},je={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4"},Me=["disabled"],Pe={key:0,class:"bg-white/90 backdrop-blur-sm rounded-2xl p-6 mb-8 shadow-xl border border-gray-100 transform transition-all duration-300"},Be={class:"flex justify-between items-center mb-6"},Le={class:"text-xl font-semibold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent"},Ue={key:0,class:"mb-6 rounded-xl bg-red-50/90 backdrop-blur-sm p-4 border border-red-100 shadow-sm"},ze={class:"flex items-center"},Te={class:"ml-3"},qe={class:"text-sm font-medium text-red-800"},He={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Fe={class:"bg-white/90 backdrop-blur-sm rounded-2xl p-8 text-center shadow-sm border border-gray-100"},De={class:"mt-6"},Ie=["disabled"],Ne={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Oe={class:"absolute top-3 right-3 flex gap-2"},Re=["onClick"],Ee=["onClick"],Ge={__name:"AdminPage",setup(a){const f=G(),p=R(),c=J(),d=b(!1),o=b(null),u=b(!1),i=b(!1),t=b(null),r=b({id:null,title:"",description:"",price:"",location:"",type:"apartment",images:[]});E(async()=>{try{await c.fetchProperties()}catch(l){o.value=l.message}});const v=async l=>{try{if(i.value=!0,o.value=null,!p.isAuthenticated)throw new Error("Требуется аутентификация");const s=l.id?await c.updateProperty(l):await c.addProperty(l);return u.value=!1,await c.fetchProperties(),s}catch(s){throw o.value=s.message||"Произошла ошибка при сохранении",console.error("Ошибка сохранения:",s),s}finally{i.value=!1}};H(()=>c.properties,()=>{d.value=!1},{immediate:!0});const C=L(()=>{const l=c.properties;return(Array.isArray(l)?l:l!=null&&l.value?l.value:[]).map(g=>({...g,images:Array.isArray(g.images)?g.images:[]}))}),_=l=>{p.isAuthenticated&&(l?r.value={id:l.id,title:l.title,description:l.description,price:l.price,location:l.location,type:l.type||"apartment",images:Array.isArray(l.images)?l.images:[]}:r.value={id:null,title:"",description:"",price:"",location:"",type:"apartment",images:[]},u.value=!0)},U=()=>{u.value=!1,r.value={id:null,title:"",description:"",price:"",location:"",type:"apartment",images:[]}},F=l=>{t.value=l},D=async()=>{try{if(!t.value)return;if(d.value=!0,o.value=null,!p.isAuthenticated)throw new Error("Требуется аутентификация");await c.deleteProperty(t.value.id),t.value=null,await c.fetchProperties()}catch(l){o.value=l.message||"Произошла ошибка при удалении",console.error("Ошибка удаления:",l)}finally{d.value=!1}},I=l=>{f.push({name:"PropertyDetail",params:{id:l}})};return(l,s)=>(n(),m("div",Ae,[s[13]||(s[13]=e("div",{class:"fixed inset-0 overflow-hidden pointer-events-none"},[e("div",{class:"absolute top-0 left-1/4 w-64 h-64 bg-blue-100 rounded-full filter blur-3xl opacity-20 animate-float-slow"}),e("div",{class:"absolute top-1/3 right-1/4 w-80 h-80 bg-indigo-100 rounded-full filter blur-3xl opacity-20 animate-float-medium"}),e("div",{class:"absolute bottom-0 left-1/2 w-72 h-72 bg-purple-100 rounded-full filter blur-3xl opacity-20 animate-float-fast"})],-1)),e("div",Se,[e("div",je,[s[4]||(s[4]=e("div",{class:"bg-white/80 backdrop-blur-sm rounded-xl p-4 shadow-sm"},[e("h1",{class:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent"}," Управление объектами "),e("p",{class:"text-gray-600 mt-1"}," Здесь вы можете управлять вашими объектами недвижимости ")],-1)),e("button",{onClick:s[0]||(s[0]=g=>_(null)),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",disabled:!q(p).isAuthenticated},s[3]||(s[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),P(" Добавить объект ")]),8,Me)]),y(A,{name:"fade-slide"},{default:k(()=>[u.value?(n(),m("div",Pe,[e("div",Be,[e("h2",Le,h(r.value.id?"Редактирование объекта":"Новый объект"),1),e("button",{onClick:U,class:"text-gray-500 hover:text-gray-700 transition-colors"},s[5]||(s[5]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),y(ce,{"model-value":r.value,"is-submitting":i.value,onSubmit:v,onCancel:U},null,8,["model-value","is-submitting"])])):$("",!0)]),_:1}),y(A,{name:"fade"},{default:k(()=>[o.value?(n(),m("div",Ue,[e("div",ze,[s[6]||(s[6]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-500",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",Te,[e("h3",qe,h(o.value),1)])])])):$("",!0)]),_:1}),d.value?(n(),m("div",He,[(n(),m(S,null,j(3,g=>y(Q,{key:g})),64))])):C.value.length===0?(n(),V(A,{key:1,name:"fade"},{default:k(()=>[e("div",Fe,[s[8]||(s[8]=e("svg",{class:"mx-auto h-16 w-16 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1)),s[9]||(s[9]=e("h3",{class:"mt-4 text-xl font-medium text-gray-900"},"Нет объектов",-1)),s[10]||(s[10]=e("p",{class:"mt-2 text-gray-600"}," Начните с добавления нового объекта недвижимости ",-1)),e("div",De,[e("button",{onClick:s[1]||(s[1]=g=>_(null)),type:"button",class:"inline-flex items-center px-6 py-3 border border-transparent text-sm font-medium rounded-xl shadow-md text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all",disabled:!q(p).isAuthenticated},s[7]||(s[7]=[e("svg",{class:"-ml-1 mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),P(" Добавить объект ")]),8,Ie)])])]),_:1})):(n(),m("div",Ne,[(n(!0),m(S,null,j(C.value,g=>(n(),V(K,{key:g.id,property:g,onClick:z=>I(g.id),class:"transform hover:scale-[1.02] transition-transform duration-300 cursor-pointer hover:shadow-lg"},{default:k(()=>[e("div",Oe,[e("button",{onClick:B(z=>_(g),["stop"]),class:"p-2 bg-white/90 backdrop-blur-sm rounded-full shadow-md hover:bg-gray-100 transition-all hover:scale-110",title:"Редактировать"},s[11]||(s[11]=[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,Re),e("button",{onClick:B(z=>F(g),["stop"]),class:"p-2 bg-white/90 backdrop-blur-sm rounded-full shadow-md hover:bg-gray-100 transition-all hover:scale-110",title:"Удалить"},s[12]||(s[12]=[e("svg",{class:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Ee)])]),_:2},1032,["property","onClick"]))),128))])),t.value?(n(),V(Ve,{key:3,"is-open":!!t.value,title:"Подтверждение удаления",message:`Вы уверены, что хотите удалить объект '${t.value.title}'?`,"confirm-text":"Удалить","cancel-text":"Отмена",variant:"danger",onConfirm:D,onCancel:s[2]||(s[2]=g=>t.value=null)},null,8,["is-open","message"])):$("",!0)])]))}},Xe=W(Ge,[["__scopeId","data-v-5e576fba"]]);export{Xe as default};
