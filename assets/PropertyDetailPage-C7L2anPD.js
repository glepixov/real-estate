import{c as o,o as r,r as d,b as S,z as j,u as A,d as m,e as g,t as n,m as _,a as e,y as F,A as V,i as w,F as h,h as f,p as z,n as L}from"./index-C5NBT51_.js";import{u as M,a as R,_ as T,P as E}from"./PropertyCard-CrY9A0rD.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={},U={class:"w-6 h-6 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"};function q(C,y){return r(),o("div",U)}const O=P(H,[["render",q]]),G={key:0,class:"flex justify-center items-center h-64"},J={key:1,class:"text-red-500 p-4"},K={key:2,class:"property-detail"},Q={key:0,class:"bg-white/90 backdrop-blur-sm rounded-xl p-3 mb-6 shadow-sm"},W={class:"list-reset flex"},X={class:"text-gray-500"},Y={key:1,class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},Z={class:"space-y-4"},ee={class:"relative aspect-[4/3] rounded-lg overflow-hidden bg-gray-100"},te=["src","alt"],se={key:0,class:"grid grid-cols-4 gap-2"},re=["onClick"],oe=["src","alt"],le={class:"flex justify-between items-start mb-4"},ae={class:"text-3xl font-bold text-gray-900"},ne={class:"text-2xl font-semibold text-blue-600 whitespace-nowrap ml-4"},ie={class:"flex items-center text-gray-500 mb-6"},ce=["innerHTML"],de={class:"bg-gray-50 rounded-lg p-6 mb-8"},ue={class:"grid grid-cols-2 gap-4"},pe={class:"text-gray-500 mr-2"},_e={class:"font-medium"},ve={key:2,class:"mt-16"},me={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ge={__name:"PropertyDetailPage",setup(C){const y=j(),b=A(),x=M(),s=d({title:"",description:"",price:0,location:"",images:[],id:"",type:"",user_id:"",created_at:""}),v=d(!0),u=d(null),i=d(""),p=d([]);S(async()=>{try{v.value=!0,u.value=null;const t=await x.fetchPropertyById(y.params.id);if(!t)throw new Error("Объект не найден");s.value={title:t.title||"Без названия",description:t.description||"",price:t.price||0,location:t.location||"Не указано",images:Array.isArray(t.images)?t.images:[],id:t.id||"",type:t.type||"apartment",user_id:t.user_id||"",created_at:t.created_at||new Date().toISOString()},s.value.images.length&&(i.value=s.value.images[0]);try{const l=await x.fetchProperties({excludeId:s.value.id,location:s.value.location,limit:3});p.value=l||[]}catch(l){console.error("Ошибка загрузки похожих объектов:",l),p.value=[]}}catch(t){u.value=t.message,console.error("Ошибка загрузки:",t),b.push("/not-found")}finally{v.value=!1}});const D=m(()=>new Intl.NumberFormat("ru-RU").format(s.value.price)),I=m(()=>{var t;return((t=s.value.description)==null?void 0:t.replace(/\n/g,"<br>"))||""}),$=m(()=>({Тип:"-",Площадь:"-",Комнат:"-",Этаж:"-","Год постройки":"-"})),B=t=>{b.push(`/property/${t}`)};return(t,l)=>{var k;const N=V("router-link");return v.value?(r(),o("div",G,[g(O)])):u.value?(r(),o("div",J,n(u.value),1)):(r(),o("div",K,[s.value.title?(r(),o("nav",Q,[e("ol",W,[e("li",null,[g(N,{to:"/",class:"text-blue-600 hover:text-blue-800"},{default:F(()=>l[0]||(l[0]=[z("Главная")])),_:1})]),l[1]||(l[1]=e("li",null,[e("span",{class:"mx-2 text-gray-500"},"/")],-1)),e("li",X,n(s.value.title),1)])])):_("",!0),s.value.title?(r(),o("div",Y,[e("div",Z,[e("div",ee,[i.value?(r(),o("img",{key:1,src:i.value,alt:s.value.title,class:"w-full h-full object-cover"},null,8,te)):(r(),w(R,{key:0,size:"full",text:s.value.title.charAt(0).toUpperCase(),class:"w-full h-full"},null,8,["text"]))]),((k=s.value.images)==null?void 0:k.length)>1?(r(),o("div",se,[(r(!0),o(h,null,f(s.value.images,(a,c)=>(r(),o("button",{key:c,onClick:he=>i.value=a,class:L(["aspect-square rounded-md overflow-hidden border-2 transition",{"border-blue-500":i.value===a,"border-transparent":i.value!==a}])},[e("img",{src:a,alt:`Изображение ${c+1}`,class:"w-full h-full object-cover"},null,8,oe)],10,re))),128))])):_("",!0)]),e("div",null,[e("div",le,[e("h1",ae,n(s.value.title),1),e("span",ne,n(D.value)+" ₽ ",1)]),e("div",ie,[g(T,{class:"w-5 h-5 mr-1"}),e("span",null,n(s.value.location),1)]),e("div",{class:"prose max-w-none mb-8",innerHTML:I.value},null,8,ce),e("div",de,[l[2]||(l[2]=e("h2",{class:"text-xl font-semibold mb-4"},"Характеристики",-1)),e("div",ue,[(r(!0),o(h,null,f($.value,(a,c)=>(r(),o("div",{key:c,class:"flex items-center"},[e("span",pe,n(c)+":",1),e("span",_e,n(a),1)]))),128))])])])])):_("",!0),p.value.length>0?(r(),o("div",ve,[l[3]||(l[3]=e("h2",{class:"text-2xl font-bold mb-6"},"Похожие объекты",-1)),e("div",me,[(r(!0),o(h,null,f(p.value,a=>(r(),w(E,{key:a.id,property:a,onClick:c=>B(a.id),class:"cursor-pointer"},null,8,["property","onClick"]))),128))])])):_("",!0)]))}}},xe=P(ge,[["__scopeId","data-v-c7e52d73"]]);export{xe as default};
